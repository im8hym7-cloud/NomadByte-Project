<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>لوحة الإدارة | SHIHNAH</title>
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; margin: 0; display: flex; }
        .sidebar { width: 250px; background: #1e293b; height: 100vh; padding: 20px; position: fixed; }
        .content { margin-right: 250px; padding: 40px; width: 100%; }
        .card-stat { background: #1e293b; padding: 20px; border-radius: 10px; border-top: 4px solid #f39c12; margin-bottom: 20px; }
        table { width: 100%; background: #1e293b; border-radius: 10px; border-collapse: collapse; }
        th, td { padding: 15px; text-align: right; border-bottom: 1px solid #334155; }
        input { background: #0f172a; color: white; border: 1px solid #444; padding: 5px; width: 70px; }
        .btn-upd { background: #f39c12; border: none; padding: 5px 10px; cursor: pointer; color: white; }
    </style>
</head>
<body>
    <div class="sidebar"><h2>SHIHNAH Admin</h2><hr><p>الإدارة العامة</p></div>
    <div class="content">
        <h1>إدارة الأسعار اللحظية</h1>
        <div class="card-stat"><h3>إجمالي العمليات اليوم: 154</h3></div>
        <table>
            <thead><tr><th>الشركة</th><th>السعر الحالي</th><th>تعديل</th></tr></thead>
            <tbody id="rows"></tbody>
        </table>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js";
        import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js";
        
        const firebaseConfig = { apiKey: "AIzaSyA_BaYYI_ZC8EO5RRMxL1Wq-_oYBAHuT2M", databaseURL: "https://sh7na-database-default-rtdb.firebaseio.com", projectId: "sh7na-database" };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        const comps = ["almajdouie", "aramex", "smsa", "zajel"];

        onValue(ref(db, 'shipping_rates'), (snap) => {
            const r = snap.val();
            const container = document.getElementById('rows');
            container.innerHTML = "";
            comps.forEach(c => {
                container.innerHTML += `<tr><td>${c}</td><td>${r[c]} ريال</td><td><input id="in-${c}" value="${r[c]}"> <button class="btn-upd" onclick="upd('${c}')">تحديث</button></td></tr>`;
            });
        });

        window.upd = (id) => {
            const val = parseFloat(document.getElementById('in-'+id).value);
            set(ref(db, 'shipping_rates/'+id), val).then(() => alert("تم التحديث"));
        }
    </script>
</body>
</html>
